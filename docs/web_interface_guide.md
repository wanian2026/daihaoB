# Web管理界面使用指南

## 🌐 简介

这是一个极简风格的Web管理界面，提供完整的交易系统管理功能。

### 特点
- ✅ **极简设计**: 黑白灰配色，简洁清爽
- ✅ **功能完整**: 包含所有交易系统功能
- ✅ **实时更新**: 自动刷新数据，实时监控
- ✅ **易于使用**: 直观的操作界面
- ✅ **响应式**: 支持不同屏幕尺寸

---

## 🚀 快速启动

### 方式一：双击脚本启动

1. 在Finder中找到 `start_web.sh`
2. 双击运行
3. 浏览器自动打开 http://localhost:8000

### 方式二：命令行启动

```bash
# 进入项目目录
cd /path/to/your/project

# 启动Web服务器
./start_web.sh

# 或者直接运行
bash start_web.sh
```

### 方式三：自定义端口

```bash
# 设置端口为8080
PORT=8080 ./start_web.sh
```

---

## 📱 界面功能

### 1. 仪表板 (Dashboard)

显示交易系统的整体状态。

**功能**:
- 总交易次数
- 总盈亏
- 胜率
- 账户余额
- 当前持仓概览

**操作**:
- 无需手动操作，自动更新数据

---

### 2. 策略配置 (Config)

创建和管理交易策略配置。

**新建策略**:
1. 选择交易所（欧易/币安）
2. 选择交易对
3. 设置上涨阈值（百分比）
4. 设置下跌阈值（百分比）
5. 设置止损比例（百分比）
6. 设置杠杆倍数
7. 选择固定仓位或比例模式
8. 点击"保存配置"

**参数说明**:

| 参数 | 说明 | 示例 |
|------|------|------|
| 上涨阈值 | 价格上涨达到此比例时触发交易 | 2% |
| 下跌阈值 | 价格下跌达到此比例时触发交易 | 2% |
| 止损比例 | 亏损达到此比例时自动止损 | 5% |
| 杠杆倍数 | 使用杠杆放大收益和风险 | 1x - 125x |
| 固定仓位 | 每次开仓的固定金额（USDT） | 100 |
| 仓位比例 | 每次开仓使用账户余额的比例 | 20% |

**管理配置**:
- 查看已保存的配置列表
- 删除不需要的配置
- 每次只能有一个活动配置

---

### 3. 交易控制 (Trading)

启动、停止、暂停、恢复交易策略。

**控制操作**:

1. **启动交易**
   - 点击"启动"按钮
   - 系统自动读取最新配置
   - 开多单和空单
   - 开始监控市场

2. **停止交易**
   - 点击"停止"按钮
   - 平掉所有持仓
   - 停止监控

3. **暂停交易**
   - 点击"暂停"按钮
   - 保留持仓
   - 暂停监控
   - 可随时恢复

4. **恢复交易**
   - 点击"恢复"按钮
   - 继续监控
   - 保持当前持仓

**市场行情**:
- 实时显示当前配置的交易对价格
- 自动更新，无需刷新

---

### 4. 持仓监控 (Positions)

查看和管理当前所有持仓。

**显示信息**:
- 持仓ID
- 交易对
- 方向（做多/做空）
- 数量
- 入场价
- 当前价
- 未实现盈亏
- 止损价
- 开仓时间

**盈亏显示**:
- 绿色：盈利
- 红色：亏损

---

### 5. 交易历史 (History)

查看所有交易记录。

**显示信息**:
- 交易ID
- 交易对
- 方向（买入/卖出）
- 订单类型
- 成交价
- 数量
- 盈亏
- 状态
- 交易时间

**状态说明**:
- 成交：订单已执行
- 待成交：订单尚未成交
- 已取消：订单被取消

---

## 🔧 高级功能

### 实时数据更新

界面每5秒自动刷新数据，包括：
- 交易状态
- 持仓信息
- 盈亏数据
- 市场价格

无需手动刷新页面。

### API密钥配置

Web界面使用与命令行相同的API密钥配置。

**配置文件**: `config/api_keys.json`

**格式**:
```json
{
  "exchanges": {
    "okx": {
      "api_key": "your_api_key",
      "secret": "your_secret",
      "passphrase": "your_passphrase",
      "sandbox": true
    },
    "binance": {
      "api_key": "your_api_key",
      "secret": "your_secret",
      "sandbox": true
    }
  }
}
```

### WebSocket实时推送

Web界面支持WebSocket实时数据推送，用于：
- 实时行情更新
- 交易状态通知
- 持仓变化通知

**端点**: `ws://localhost:8000/ws`

---

## 📊 数据分析

### 性能统计

在仪表板中查看整体表现：

- **总交易次数**: 所有成交的订单数量
- **总盈亏**: 所有交易的累计盈亏
- **胜率**: 盈利交易占总交易的比例

### 持仓分析

实时监控所有持仓：
- 查看未实现盈亏
- 追踪止损价格
- 监控入场价格

---

## ⚠️ 注意事项

### 首次使用

1. **配置API密钥**
   - 确保 `config/api_keys.json` 已正确配置
   - 建议先使用模拟交易测试

2. **创建策略配置**
   - 在"策略配置"页面创建第一个配置
   - 参数要合理，不要设置过大

3. **启动交易**
   - 在"交易控制"页面点击"启动"
   - 观察仪表板确认运行正常

### 风险管理

- ✅ 使用模拟交易先测试
- ✅ 设置合理的止损比例
- ✅ 不要使用过高的杠杆
- ✅ 定期检查持仓状态
- ❌ 不要同时运行多个策略
- ❌ 不要频繁修改配置

### 故障排除

**问题1: 无法连接交易所**

- 检查API密钥是否正确
- 确认网络连接正常
- 检查交易所是否正常维护

**问题2: 启动交易失败**

- 确保至少有一个策略配置
- 检查API密钥权限（需要交易权限）
- 查看浏览器控制台错误信息

**问题3: 数据不更新**

- 检查网络连接
- 刷新浏览器页面
- 查看Web服务器日志

**问题4: 余额显示为0**

- 确认交易所配置正确
- 检查账户是否有USDT余额
- 刷新页面重新加载

---

## 🎯 最佳实践

### 策略配置

1. **从小开始**
   - 首次使用使用小仓位测试
   - 比例模式建议20%以下
   - 固定仓位建议100 USDT以下

2. **合理参数**
   - 阈值：2-5%
   - 止损：5-10%
   - 杠杆：1-5倍（新手1倍）

3. **风险管理**
   - 设置止损
   - 分散风险
   - 不要过度交易

### 监控交易

1. **定期检查**
   - 每天查看一次持仓
   - 关注盈亏变化
   - 及时调整策略

2. **日志记录**
   - 查看交易历史
   - 分析成功和失败的交易
   - 不断优化策略

---

## 📚 API文档

### 策略配置API

**获取所有配置**
```
GET /api/strategy/configs
```

**创建配置**
```
POST /api/strategy/config
Content-Type: application/json

{
  "exchange": "okx",
  "symbol": "BTC/USDT",
  "long_threshold": 0.02,
  "short_threshold": 0.02,
  "stop_loss_ratio": 0.05,
  "leverage": 1
}
```

**删除配置**
```
DELETE /api/strategy/config/{config_id}
```

### 交易控制API

**控制交易**
```
POST /api/trading/control
Content-Type: application/json

{
  "action": "start"  // start, stop, pause, resume
}
```

**获取交易状态**
```
GET /api/trading/status
```

### 数据查询API

**获取持仓**
```
GET /api/positions
```

**获取交易历史**
```
GET /api/trades?limit=100
```

**获取性能统计**
```
GET /api/performance
```

---

## 🔐 安全建议

1. **保护API密钥**
   - 不要将API密钥上传到GitHub
   - 使用不同的密钥用于模拟和正式交易
   - 定期更换API密钥

2. **使用模拟交易**
   - 新手必须使用模拟交易
   - 测试策略有效性
   - 熟悉界面操作

3. **限制权限**
   - API密钥禁用提币权限
   - 绑定IP白名单
   - 使用安全验证

---

## 💡 提示

- 💻 建议使用Chrome或Firefox浏览器
- 📱 支持手机浏览器（部分功能受限）
- 🔄 按 F5 刷新页面
- 📊 打开浏览器开发者工具查看日志
- 🚫 不要同时打开多个标签页

---

## 📞 获取帮助

- 查看项目文档: `docs/`
- 查看API文档: 访问 http://localhost:8000/docs
- 查看错误日志: `logs/trading.log`

---

**开始使用Web界面，享受便捷的交易管理体验！**
